\chapter{Introduction}

\section{Genetic Mapping}

Genetic mapping is a scientific endeavor that has elucidated the genetic underpinnings of hundreds of conditions relevant to human health and disease, both directly in humans \citep{MacArthur2017} and in model organisms \citep{Grubb2014a}, as well as many commercially-important traits in crops and livestock.
There are, broadly speaking, three approaches to genetic mapping, which I will discuss below.
They are united in their goal and the general process by which they seek to achieve it.

All approaches to genetic mapping involve the collection of phenotype and genotype information on a population of organisms and a statistical analysis to test for associations between the phenotype and each measured, polymorphic locus of the genome.
This endeavor is motivated by the belief that the vast majority of the genome, say greater than 99\%, does not have any appreciable effect on the phenotype, so a successful genetic mapping experiment allows researchers interested in the phenotype to focus their efforts on the small section of the genome that does have an effect.
Thus, a successful genetic mapping effort results in a partition of the genome into a large part with no appreciable effect on the trait of interest, and a small part believed with a high degree of certainty to influence the phenotype.

The three general approaches to genetic mapping are:
\begin{enumerate*}
	\item linkage analysis, 
	\item linkage disequilibrium mapping, and
	\item association mapping.
\end{enumerate*}
I'll briefly review these approaches and some examples of how each has been productively applied.


\paragraph{Linkage Analysis} is most useful for traits where one or a few genetic factors are expected to exert a large effect \citep{Elston1971,Haseman1972}.
It is based on a large collection of families with a few individuals per family, where each family must have at least one affected and one unaffected individual and everyone has been genotyped across a sparse panel of markers.
Examples of successful applications of linkage analysis are Mendelian disease phenotypes like Duchenne muscular dystrophy, \citep{Brown1985,Murray1982} cystic fibrosis \citep{Tsui1985,Wainwright1985,White1985} and ataxia-telangiectasia \citep{Gatti1988}.
In the last decade, as denser marker panels have become available and many of the high-prevalence, near-Mendelian traits have been mapped, linkage analysis has receded in prominence.
	

\paragraph{Linkage disequilibrium mapping} involves an experimental population of organisms where the pattern of descent from a reference population can be inferred.
For that reason, it is only possible in model organisms, livestock, and some crops --- but never in humans.
Strengths of this approach include the tight control of environmental exposures and the opportunity to deeply and invasively measure phenotypes.
Two of the most classic designs, the F2 intercross and backcross, mimic the pedigrees of human linkage mapping, but rather than using many families with a few individuals per family, they create a single family with hundreds of siblings \citep{Lynch1998,Lander1987,Lander1989a}.
Because these designs restrict the total genetic variation to only two parental haplotypes, rather than the vast number of haplotypes represented in a collection of human families, they are able to detect smaller effects and are not restricted to analyze mono- or oligo-genic traits in the way that linkage analysis is.

Modern efforts toward model organism LD mapping have made prominent use of more elaborate breeding designs, most prominently multi-parental outbred populations \citep{Ghazalpour2012b,Svenson2012a} and multi-parental genetic reference populations \citep{TheComplexTraitConsortium2004,MacKay2012,King2012} as well as in commercially-important crops \citep{McMullen2009,Bandillo2013}.
These designs use a larger number of parental haplotypes and therefore explore a larger space of possible genetic effects than classic designs like F2's and backcrosses.
In this way, multi-parental populations designed for LD mapping strike a middle ground between classical designs and association analysis, which I discuss below.


\paragraph{Association mapping (GWAS)} is based on a large population of individuals with no particular genetic relationship.
Because no breeding is required, it can be conducted in human populations.
It is most appropriate for traits where many genetic factors are thought to exert an effect, like body mass index \citep{Speliotes2010,Locke2015} and height \citep{Allen2010,Wood2014-fh} and psychiatric conditions like schizophrenia \citep{Ripke2014a} and depression \citep{PGC2017}.
Each genetic locus is tested for association with the phenotype after a correction is made for global genetic similarity between individuals \citep{Lippert2011,Zhou2012}.

% Because of the complex relationships within a large population of humans, a dense marker map [is required to 

\paragraph{Association mapping in model organisms} uses a panel of inbred organisms with no particular genetic relationship to conduct a study similar to a human GWAS.
This study design combines the strengths of model organism experiments (the tight control of environmental exposures and the ability to make invasive measurements) with the ability to observe replicates from each genome \citep{Payseur2007a,Kang2008,Kirby2010a}.
One important strength of a study design that allows multiple observations of the same genotype is that it allows for very precise measurement of the average phenotype that results from a given genotype because that genotype can be observed arbitrarily-many times.
Additionally, it allows for direct quantification of environmental variance, which is confounded with genetic variance in any population without genetically-identical individuals \citep{Falconer1965,Lynch1998}.

% \end{enumerate}
% Similarly, association mapping can be divided into two categories:
% \begin{enumerate}
% 	\item \textbf{GWAS (Human association mapping)} is based on a large population of not-closely-related individuals.
	
% 	% \item \textbf{Outbred model organism association mapping} is, from a genetics perspective, the same \WV{process as human association mapping.}{Not quite. There are at least two approaches: LD mapping, whereby we reconstruct haplotypes and use those for the association (see earlier comment); and GWAS, where, as with human GWAS we used observed genotypes. This distinction used to more often be described as between mapping using identity by descent (IBD) and using identity by state (IBS); in the case of mapping in HS or DO, note that IBS information is converted to IBD information via an HMM. A third method used is actual linkage mapping, which is a type of IBD based more explicitly on the pedigree --- Marco Bink's FlexQTL does this, for example.}
% 	% Its advantage over human association mapping is that environmental exposures can be tightly controlled and more invasive measurements can be made \citep{Falconer1965,Lynch1998}.
% 	\item \textbf{Inbred strain association mapping} 

% 	% Unlike LD mapping in a multi-parental genetic reference population, however, the analysis is based only on the measured SNPs and phenotypes, not on any additional information about the relatedness of the organisms.
% 	% This approach has been applied productively , but somewhat subsumed by multi-parental genetic reference population LD mapping.

% 	% capitalizes on the replicability of inbred organisms in the same way as LD mapping in genetic reference populationsanother possibility that is unavailable in human association mapping --- that of a diverse panel of genetically-replicable individuals.
% 	% 
% 	% Inbred strain association mapping has been applied productively in model organisms of human physiology and disease .
% \end{enumerate}

Across all these approaches to genetic mapping, the goal remains the same --- to identify genetic loci where allelic variation correlates with phenotype variation.

\section{Variation and Variance}

We can say that we have observed ``Variation'' in some quantity when we have observed at least two different values for that quantity.
Without phenotype variation, no analysis of any kind is possible, genetic or otherwise.
Imagine a QTL mapping study where a tremendous amount of genotypic variation was measured, but, by chance, all individuals in the mapping population have the same phenotype value to measured precision.
Realistically, the problem in such a study is that we did not measure the phenotype to sufficient precision --- maybe the scale we used to measure mouse bodyweight was only accurate to the nearest pound, or maybe the phenotype is a molecular phenotype for which the state-of-the-art measurement procedure cannot differentiate between the highest and lowest values in our population.
But more theoretically, given a set of observations without any variation, there can be no attempt to correlate it with variation in any other quantity, be they other phenotypes, environmental exposures, or genetic factors.

Analogously, for any genetic locus where all individuals in the mapping population have the same allele, no genetic mapping study can hope to identify an association.
This statement is quite different from a mechanistic assessment that determines the gene products of this locus are irrelevant to the phenotype of interest; no such assessment can be made.
Genetic mapping is fundamentally a statistical, rather than mechanistic process, simply testing for correlations between phenotype variation and allelic variation.

The above discussion considered variation as a binary quantity; it's either present or absent.
But there are a variety of measures that can be used to quantify variation.
Some examples include the range, the interquartile range, the standard deviation, the mean absolute deviation, and the variance.
This dissertation deals almost exclusively with the variance because it has the salutary property that the sum of the variance attributable to each individual factor in a regression analysis is equal to the variance of the response (the phenotype in genetic applications).
Put simply the variance of a sample of numbers is the sum of the squared differences between each number and the mean.
For a large sample of numbers, this quantity accurately estimates the variance of the random process by which the numbers were generated.

At times, this dissertation also considers the standard deviation, which is simply the square root of the variance.
The standard deviation has the property that it is on the same scale as the phenotype itself, and is therefore straightforwardly interpretable.

\section{Sources of Variance}

It is important to recognize all potential sources of variance in a population in which a genetic mapping study will be conducted.
Understanding genetic parameters such as broad sense and narrow sense heritability, the percentage of variance explained by aggregate additive, dominance, and epistatic effects yields valuable insights into the ``genetic architecture'' of the trait.
Understanding the effect of sex, bodyweight, and nuisance covariates such as housing, diet, and experimenter can help scientists design more efficient experiments \citep{Nettleton2006,Datta2014}.
I'll begin by reviewing sources of variance in measurements made on a single organism.
As discussed previously, in the absence of any genetic variation, there can be no prospect for genetic insight.
I continue with a review of sources of variance in measurements of multiple organisms, keeping in mind that the single-organism sources of variance are still present.


\subsection{Measurements on a Single Organism}

There are surprisingly many sources of variance when multiple measurements are made, even on a single organism. % (\autoref{tab:sources_of_variance_single_org}).

When multiple measurements of a given trait are made on a single individual at the same time, the only source of variance is technical variance \citep{Ronnegard2011a}.
An example of this type of measurement is the collection of a single blood sample from a mouse, which is split it into three aliquots and the mRNA content of each aliquot is analyzed independently \citep{Marioni2008}.

When the a phenotype is measured on one individual at multiple times, temporal fluctuation is a potential source of variance.
This temporal fluctuation comes in two ``flavors''.
First, the value of the phenotype of the individual may change over time.
Second, the measurement device may change over time.
Effects of this type are often called ``batch effects''.
An example of this type of measurement is the weighing of each experimental mouse each day of a multi-day experiment \citep{Gray2015}.

When the same organism is observed in multiple different ``macro-environments'', that variation in macro-environment can contribute variance to the phenotype.
The term ``macro-environment'' is used here to signify that the researcher has intentionally introduced an environmental effect.
It is used in contrast to the ``micro-environment'', which is discussed below.
The same individual could be exposed to multiple different macro-environments at different times in its life, in which case temporal variation would potentially be in play, or samples of the organism can be extracted and treated with different environmental factors at a single time point.

When multiple, theoretically-identical structures are measured on a single individual at a single time, ``fluctuating asymmetry'' is a potential source of variance \citep{Palmer1986}.
An example of this type of experiment is be measurement of the left and right kidney weight of mice \citep{Leamy2000,Leamy2002}.
There are valid criticisms to be made about many specific measurements that are said to reflect fluctuating asymmetry.
For example, in the case of the left and right kidney in a mouse, some difference in size might be expected due to the right kidney being crowded by the liver during development.
But the general concept, that of assessing the extent to which multiple theoretically-identical phenotypes are expressed identically in a given organism, is an important contribution to understanding the totality of sources of variance in a phenotype, for phenotypes where it is applicable.

A further source of variance in measurements of theoretically-identical structures from the same organism is developmental stochasticity.
This term refers to the concept that micro-environmental perturbations during the developmental process can ``fix'' larger changes later in life, similar to a ``butterfly effect'' of developmental biology.

\begin{sidewaystable}
	% \begin{tabular}{p{6cm}ccccc}
	% 	& \multicolumn{5}{c}{sources of variance}\\
	% \cmidrule[0.1pt]{2-6}
	% 	& \multirow{1}{2.5cm}{\centering measurement error} 
	% 	& \multirow{1}{2.5cm}{\centering organismal fluctuation}
	% 	& \multirow{1}{2.5cm}{\centering device fluctuation}
	% 	& \multirow{1}{3.5cm}{\centering macro-environmental variance}
	% 	& \multirow{1}{3cm}{\centering fluctuating asymmetry}\\\\
	% \cmidrule[1pt]{2-6}
	% 	different times & \textbullet & \textbullet & \textbullet \\
	% \cmidrule[0.1pt]{1-6}
	% 	different macro-environments & \textbullet & & & \textbullet\\
	% \cmidrule[0.1pt]{1-6}
	% 	different instances of \newline theoretically-identical structure & \textbullet & & & & \textbullet\\
	% \cmidrule[0.1pt]{1-6}
	% \end{tabular}
	\centering
	\begin{tabular}{c}
	\cmidrule[0.1pt]{1-1}
		\hspace{1cm}sources of single organism variance\hspace*{1cm}\\
	% \hline
	\cmidrule[1pt]{1-1}
		measurement error\\
		organism fluctuation\\
		device fluctuation\\
		developmental stochasticity\\
		macro-environment effects\\
		fluctuating asymmetry\\
	% \hline
	\cmidrule[0.1pt]{1-1}
	\end{tabular}
	\caption[
		Sources of variance in measurements of a single organism.
	]
	{
		Sources of variance that contribute to total phenotype variance in measurements of a single organism.
		Note that measurement error is present in all measurements.
		Organismal fluctuation and device fluctuation are both the result of taking measurements at different times, but they can be deconfounded with designs that cross individuals and devices.
	}
	\label{tab:sources_of_variance_single_org}
	\vspace{1in}
	\begin{tabular}{p{6cm}cccc}
		& \multicolumn{4}{c}{sources of variance}\\
	\cmidrule[0.1pt]{2-5}
				& \multirow{1}{2.5cm}{\centering single organism variance} 
				& \multirow{1}{2.5cm}{\centering developmental stochasticity}
				& \multirow{1}{2.5cm}{\centering locus-by-G and locus-by-E}
				& \multirow{1}{3.5cm}{\centering marginal effects of all polymorphic loci}\\\\
	\cmidrule[1pt]{2-5}
		one organism 	& \textbullet & \\
		genetically-identical organisms & \textbullet & \textbullet\\
		organisms with same allele at a locus & \textbullet & \textbullet & \textbullet\\
		genetically-distinct organisms & \textbullet & \textbullet & \textbullet & \textbullet\\
	\cmidrule[0.1pt]{1-5}
	\end{tabular}
	\caption[
		Sources of variance in measurements of multiple organisms.
	]
	{
		Sources of variance that contribute to total phenotype variance in measurements of multiple organisms.
		The first column represents all the sources of variance that can be present in a measurement of a single organism (\autoref{tab:sources_of_variance_single_org}).
		Note the hierarchical nature of the sources of variance as we progress down the table from more-closely related individuals to less-closely related individuals; new sources of variance are added, but never removed.
	}
	\label{tab:sources_of_variance_multi_org}
\end{sidewaystable}


\subsection{Measurements on Multiple Organisms}

When multiple organisms are observed, additional layers of variance are possible, depending on the genetics of the organisms (\autoref{tab:sources_of_variance_multi_org}).

The experimental design that most limits the variance amongst multiple organisms is when all the organisms are genetically identical.
In the observation of multiple genetically-identical organisms, developmental stochasticity, is a potential source of variation \citep{Fraser2010}.
This same source of variance can also be referred to as ``micro-environmental variance'' \citep{Hill2010}.
This type of variance captures all the myriad, subtle exposures that each organism experiences, but which no researcher can hope to standardize.
For example, the precise living temperature a mouse experiences depends slightly on where its cage is relative to the air vents, the amount of bedding depends on exactly how much the technician happened to grab when filling the cage, and uncountably many more such small effects could be imagined.
Outside of experimental designs that make use of inbred organisms, it is impossible to directly estimate the contribution of micro-environmental variance to phenotype variance.

Consider a population of organisms that is not genetically identical in a global sense, but is genetically identical at one specific locus.
A potential source of phenotype variance in such a population is interactions between the locus and factors in which the organisms do vary, such as other genetic loci and micro-environmental exposures.
The fact that all the organisms have the same allele at the focal locus precludes any direct contribution from that locus to the phenotype variance.
But, the locus may interact with polymorphisms elsewhere in the genome to make a contribution to the phenotype variance through GxG or may interact with micro-environmental factors to make a contribution through GxE \citep{Falconer1995-od,Struchalin2010,Ronnegard2011a}.

Consider next a population of organisms where there are multiple alleles present at the focal locus --- one could imagine the same population as the above paragraph but simply focus on a different locus.
Here, all the same effects described above could be present, and additionally a marginal effect of the locus could contribute to phenotype variance.
In fact, this is the reasoning that underlies the vast majority of QTL mapping efforts.
Any genetic locus where researchers conclude with high statistical certainty that the proportion of phenotype variance explained by the locus is not zero constitutes a QTL \citep{Broman2009,Broman2010}.

Having considered thoroughly many possible sources of variance, I turn next to the concept that not all organisms are influenced by them to equal extent.

\section{Variance Heterogeneity}

% The fundamental concept of variance heterogeneity is the recognition that not all measurements are influenced by all sources of variance to an equal extent.
Conceptually, any of the sources of variance described above could contribute more or less to any one measurement and any factor could determine how much a given source of variance contributes.
This situation is termed ``variance heterogeneity''.
The measurements could all end up with the same variance, and it's simply partitioned differently according to sources.
Or they could end up with different total variance.

Despite this reality, most genetics studies impose strong assumptions about the nature of phenotype variation.
They use statistical models that assume that each measurement has an equal quantity of variance from each source.
To put a concrete example to that statement, the statistical analysis most commonly used in LD mapping of an F2 intercross or backcross assumes that the residual variance is constant across all individuals.
In this study design, the ``residual variance'' is the sum of all within-individual sources of variance described above, the genomic variance arising from genetic factors other than the locus currently being tested (which I term the ``focal locus''), locus-by-genome interactions, and locus-by-micro-environment interactions.
So the assumption is equivalent to the belief that, across all organisms in the mapping population, that sum is equal.

Other study designs that are often analyzed with the assumption of homogeneous variance include pedigree analysis to determine breeding values and heritability, inbred strain association mapping, and human GWAS.

Despite the pervasiveness of these ``constant variance'' assumptions, there is ample evidence that these sources of variance do not affect each measurement equally.
Rather this assumption arises out of analytic convenience.
Statistical models that make use of the homogeneous variance assumption have been more straightforward to develop and tend to have faster performance than more complex models that allow for variance heterogeneity.
This situation formed the central tension of my dissertation work.
\textbf{It was my belief that the analysis of many genetic study designs could be improved by using statistical models that recognize, and in some ways even capitalize on, variance heterogeneity.}

\subsection{Evidence of Variance Heterogeneity}

Why might measurements from one organism have more variance than measurements from another organism?
If one device is used for one organism and another device is used for another, heterogeneity of measurement error could result in heterogeneity of phenotype variance.
Observations of this type have been made in the field of human blood pressure management \citep{Labarthe1973,Ataman1996,OBrien2001}.

As another example, genetic factors could influence phenotype variance by influencing sensitivity to variation in the micro-environment or influencing the extent of GxG or GxE variance.
Family-based designs cannot disentangle these two sources of variance, but they can document their presence.
For example, genomic effects on phenotype variance have been documented in cattle \citep{Visscher1992-ka,Mulder2008-pr,Fasoula2012-ji}, dairy cow \citep{clay1979heterogeneity}, pigs \citep{Ibanez-Escriche2008}, chickens \citep{Rowe2006}, snails \citep{Ros2004}.

Other studies have documented a heterogeneity of phenotype variance across inbred strains, which can only be caused by differences in micro-environmental variation.
Theses studies have documented this phenomenon in \textit{Drosophila melanogaster} \citep{Mackay2005,Mackay2014-vi}, \textit{Arabidopsis thaliana} \citep{Hall2007}, and crops \citep{Walsh2017-vx}.


Early theoretical work focused on the notion that organisms with one allele at a locus might all have a similar phenotype, while organisms with the other allele might have very different phenotypes, despite tremendous variation in the rest of the genome in both groups and termed this phenomenon ``canalization'' \citep{Waddington1942,Waddington1959}.
This work has been extended to include a population genetic theory of how it could come about \citep{Wagner1997,Gibson2000,Meiklejohn2002}.
It has been related to the concept of ``modularity'' \citep{Wagner2007}, of ``developmental constraint'' \citep{Pavlicev2015-nu}.
The original concept is now referred to as ``robustness'' \citep{Kitano2004,Felix2015,Yadav2015-sw,Fraser2010} as well as ``capacitance'' \citep{Pettersson2015-bl,Queitsch2002}.
Usefully, the concept of robustness is divided into environmental robustness and genomic robustness \citep{Fraser2010}, where the former refers to heterogeneity of locus-by-E variance and the latter to heterogeneity of locus-by-G variance.


 % and ``micro-environmental plasticity'' \citep{Lin2016-eh,Mulder2013a,Sztepanacz2017-zg,Morgante2015}.

% The heritability of micro-environmental variance, or simply ``environmental variance'' has been thoroughly documented in livestock, model organisms, and humans \citep{Mulder2016-tr}

% Conceptually, 

% Review some of the lit that's not directly relevant to QTL mapping,
% ie robustness, pop gen of het var, systems bio stuff about hub  nodes, hsp90, summarize stuff out of Ronnegard and Valdar 2011, pulling some stuff from paper intros....


% Two populations have different phenotype variance.
% Two individuals have different phenotype variance -- continuous version of the above.

% Describe exchangeable and non-exchangeable populations

% In an exchangeable pop, knowing 

% \begin{table}[ht]
% 	\begin{tabular}{lp{1in}p{1in}p{1in}}
% 		\toprule
% 				& accommodate variance heterogeneity & detect variance heterogeneity & handle differential relatedness\\
% 		\midrule
% 		LM 		& no	& no	& no\\
% 		DGLM 	& yes 	& yes 	& no\\
% 		LMM  	& no 	& no	& yes\\
% 		wLMM	& yes	& no	& yes\\
% 		\bottomrule
% 	\end{tabular}
% \end{table}

\section{QTL Mapping in the Presence of Variance Heterogeneity}

Given the limited focus of the genetics community on variance heterogeneity, despite its seeming ubiquity, I sought to assess the ways in which it could damage QTL mapping efforts, through false positive or false negative results, and whether there were ways in which the presence of variance heterogeneity could actually \textit{strengthen} genetic mapping efforts.

% Quantitative trait locus (QTL) mapping in experimental crosses involves applying a statistical test for genotype-phenotype association to each locus in the genome.
% Traditionally, tests are used that quantify the association between the genotype and the phenotype mean \citep{Lander1989-sd,Haley1992-xg,Martinez1992-qd,Kruglyak1995-tz}, which we term “mQTL” tests.
% mQTL tests are a natural fit for QTL mapping because of 
% 	the robust theory describing genetic effects on phenotype mean \citep{Falconer1995-od,Lynch1998-mx}, 
% 	the historical importance of genotype effects on phenotype mean in the field of agricultural and livestock genetics, where the sum of additive effects on the mean (the breeding value) is the focal quantity \citep{Henderson1975-fe,Meuwissen2001-ms}, 
% 	and the fact that many genetic factors truly do influence the expected value of important traits \citep{Bloom2013-iq,Wood2014-fh,Schizophrenia_Working_Group_of_the_Psychiatric_Genomics_Consortium2014-mt}.
% As the workhorse of genetic mapping for the last 20 years, mQTL tests have thoroughly-described statistical properties and there are widely-accepted procedures and software for their use \citep{Broman2003-pp,Broman2010-nr}.

% Recently, an additional type of test has become entered the mainstream of genetic mapping efforts, those that quantify the association between genotype and phenotype variance, termed ``vQTL tests'' \citep{Pare2010-wz}.
% Just as mQTL mapping is a natural extension of breeding value estimation, vQTL testing can be understood as the natural extension of estimation of breeding value for uniformity.
% In both cases, whole-genome insight that were commercially valuable led to the development of tests that can localize these effects to specific regions of the genome and therefore yield biological insights into the mechanisms that influence the trait of interest.
% % {Hulse2013-vu,Wang2014-la,Wang2017-og}.
% vQTL tests have been used to map GxG \citep{Wei2016-lt}, GxE \citep{Wei2017-tt}, and other more exotic genetic architectures that are often missed by mQTL tests (LD correlation?) (relQTL).
% Other vQTL have been identified as such, but not yet 
% Owing to its relative novelty in comparison to mQTL mapping, there are fewer established guidelines on how to test for vQTL and therefore great heterogeneity in recent approaches.
% For example, [long list, including Hulse and Cai, Payseur, etc…see vqtl lit table] 

Quantitative trait locus (QTL) mapping in both model organisms and humans has traditionally focused on finding regions of the genome whose allelic variation influences the phenotypic mean.
In the past decade, a number of studies and proposed methods have broadened the scope of QTL mapping to consider effects on the phenotypic variance \citep{Pare2010,Ronnegard2011a,Hulse2013}. 
These studies and their findings have raised interesting questions and possibilities about underlying biology, evolutionary trajectory, and potential utility in agriculture \citep{Wagner1997,Dworkin2005,Mulder2015}.
Nonetheless, consideration of variance effects --- whether as the target of inference or as a feature of the data to be accommodated ---
has thus far remained outside of routine genetic analysis.
This may be in part because QTL effects on the variance are sometimes considered of esoteric secondary interest, intrinsically controversial in their interpretation due to considerations of data scale \citep{Sun2013a,Shen2013}, or a priori too hard to detect \citep{Visscher2010a}.
But it is also likely to be in part because familiar software and procedures are currently lacking, and because the advantages of modeling heterogeneous variance, even when targeting QTL effects on the phenotypic mean, remain under-appreciated and largely undemonstrated.

The predominant approach to QTL mapping in model organisms, the focus here, considers each genetic locus in turn, using a standard linear model (SLM) to regress the phenotypes of the mapping population on their genotypes or their inferred genotype probabilities \citep{Lander1989a,Haley1992}.
This SLM-based approach is primarily able to detect genomic regions containing a subset of genetic factors of interest --- those that drive heterogeneity of phenotype mean.
Despite this limited scope, however, its use is widespread due to its ease of use, the straightforward interpretation of its detected QTL, its historical importance in the fields of agricultural and livestock genetics, and the fact that many genetic factors truly do influence the expected value of phenotypes.
Indeed, SLM-based interval mapping has yielded important insights on commercially- and medically-important traits across many organisms for many years.

%Quantitative trait locus (QTL) mapping in model organisms aims to identify genomic regions where allelic variation influences a continuous-valued trait of interest for follow-up bioinformatic and mechanistic studies.The predominant approach considers each genetic locus in turn, using a standard linear model (SLM) to regress the phenotypes of the mapping population on their genotypes or their inferred genotype probabilities \citep{Lander1989a,Haley1992,Klein2005}. This SLM-based approach is primarily able to detect genomic regions containing a subset of genetic factors of interest --- those that drive heterogeneity of phenotype mean. Despite this limited scope, however, its use is widespread due to its ease of use, the straightforward interpretation of its detected QTL, its historical importance in the fields of agricultural and livestock genetics, and the fact that many genetic factors truly do influence the expected value of phenotypes.
%Indeed, SLM-based interval mapping has yielded important insights on commerically- and medically-important traits across many organisms for many years \citep{Brem2002,Thornsberry2001,Huang2010}.

The goal of QTL mapping, however, is much broader --- to identify genetic factors that influence the phenotype in any way.
For example, a genetic factor that influences the sensitivity of the phenotype to micro-environmental variation through a collection of what might be called a locus-by-E interactions is of interest whether the identity of the micro-environmental factors is known or not, but unless it also affects the mean it is undetectable by the SLM.
Similarly, a genetic factor that influences the phenotype through many epistatic interactions (a collection of locus-by-G effects), but has an average effect near zero is unlikely to be detected by the SLM.
Neither of these important goals, however, was the original motivation for seeking to detect genetic loci that influence phenotype variance.
The original motivation was to lower the dimensionality of the search space for large locus-by-locus interactions \citep{Pare2010}, by searching first for variants that influence the variance and then searching for interaction effects between those loci and the rest of the genome.
Such QTL that influence phenotype variance are often termed ``vQTL''.
The goal of detecting vQTL and other more exotic types of QTL effects motivated the development and application of statistical tests that can detect genetic effects on other aspects of the phenotypic distribution, most notably the phenotype variance.

A number of statistical models and methods have been developed or adapted to identify associations between genotype and phenotypic variance. 
These include: 
    Levene's test \citep{Struchalin2010},
    the Fligner-Killeen test \citep{Fraser2010},
    Bartlett's test \citep{Freund2013b},
    the double generalized linear model (DGLM) and similar \citep{Ronnegard2011a, Cao2014},
    and a host of two-step procedures that involve computing measure of variance for each individual and testing that quantity for relation to the tested locus \citep{Brown2014-kv,Ayroles2015,Forsberg2015-jy}.
Tests have also been developed to detect genotype associations with arbitrary functions of the phenotype, for example higher moments.
These include a variant of the Komolgorov-Smirnov test \citep{Aschard2013} and a semi-parametric exponential tilt model \citep{Hong2016}.
The additional flexibility of these latter models makes them promising --- a genetic factor that influences, e.g., the kurtosis of a phenotype should be of interest --- but at present neither can accommodate covariates and the flexibility that affords them the ability to detect higher order effects brings with it a decreased power to detect mean and variance effects. 

Efforts to identify vQTL have gathered steam in recent years.
A few dozen vQTL have been reported, spanning \textit{Arabidopsis thaliana} \citep{Jimenez-Gomez2011a,Shen2012,Forsberg2014-je}, flowers \citep{Lee2014-wp}, dairy cows \citep{Fikse2012-vm}, \textit{Drosophila melanogaster} \citep{Ayroles2015,Huang2015-ar}, layer chickens \citep{Wolc2012-sq}, maize \citep{Ordas2008}, mouse \citep{Gray2015}, and yeast \citep{Nelson2013-ld,Ziv2017-cf,Forsberg2017-bv}.
In at least two cases, researchers have identified vQTL and then gone on to identify specific interactions that caused the appearance of that vQTL \citep{Huang2015-ar,Brown2017-pt}, one of the original stated goals of vQTL analysis.

The existence of a vQTL, or indeed any factor affecting the variance has implications regarding statistical genetic analyses, both those targeting variance effects and those targeted mean-affecting QTL (hereafter, ``mQTL''), and these implications have been relatively unexamined. 

In particular, if a genetic (or other) factor influences phenotype variance then it follows that examination and testing of any other QTL effect --- for example, that of a QTL elsewhere in the genome --- must occur against a backdrop of systematically heterogeneous residual variance.
The presence of this ``background variance heterogeneity'' (BVH) when testing for a (foreground) effect simultaneously presents analytic challenges and opportunities, not only for mapping vQTL but also the validity of studies detecting mQTL. 

The impact of BVH on mapping mQTL can be thought of as a disruption of the natural observation weights: The SLM assumes the phenotype of every individual is subject to equal noise variance and therefore equal weight; but if it is known that some individuals' phenotypes are inherently less noisy --- due to BVH induced by either a vQTL or other factors such as sex, housing, strain or experimenter --- then those data should be upweighted, and this would lead to a more powerful test for mQTL detection.
Conversely, giving equal weight to subgroups of the data that are inherently noisier than average has the potential to leave outliers with overmuch influence on the regression, increasing the potential for false positive mQTL detections
A case in point is when an mQTL also has variance effects: here the effects on the variance are a type of proximal BVH, and modeling them explicitly improves ability to detect effects on the mean, as in \autoref{chap:mvqtl_reanalyses}.
Knowledge and appropriate modeling of variance heterogeneity therefore has important implications for making mean-controlling QTL studies sensitive, robust and reproducible.

The impact of BVH on detection of foreground vQTL is more subtle. Parametric methods to identify vQTL typically pit heterogeneous variance alternative models against a homoskedastic, normally distributed null.
However, under BVH the null model is not homoskedastic --- it is a scale mixture --- and this risks the null being rejected too readily.
BVH could therefore lead to an inflated vQTL false positive rate.

If BVH is disruptive to QTL mapping generally, it is potentially valuable to incorporate it into the QTL mapping model when its source is known, and to use robustifying techniques to protect against it when its source is unknown.
Accommodating BVH of known source is most naturally achieved through modeling covariate effects on the variance, something that is straightforward with the DGLM of \cite{Ronnegard2011a} but not currently with other proposed methods. 
Protecting BVH when its source is unknown is less obvious, but since the threat manifests through sensitivity to distributional assumptions, natural contenders include side-stepping such assumptions via non-parametric approaches, \eg, permutation testing, or reshaping the distribution prior to analysis through variable transformation.
Both have been considered in the vQTL context, with permutation used in \cite{Hulse2013} and \cite{Yang2012} and transformation in \cite{Ronnegard2011a}, \cite{Yang2012}, \cite{Sun2013a}, and \cite{Shen2013a}, but not specifically for controlling vQTL false positives in the presence of BVH.



% Here we examine the effect of modeled and unmodeled BVH on power and false positive rate when mapping QTL affecting the mean, the variance or both.
% In doing so we:
% \begin{enumerate}
% \item Develop a robust, straightforward procedure and software based on the DGLM that can be used for routine mQTL and vQTL analysis;
% \item Compare alternative proposed methods for mQTL and vQTL analysis;
% \item Show how incorporating BVH can improve power for detecting mQTL and vQTL;
% \item Show how sensitivity to model assumptions can be rescued by variable transformation and/or permutation. 
% \item Illustrate the effect of modeling BVH in existing dataset, an F2 cross from Leamy et al, and discover a new QTL for bodyweight.
% \end{enumerate}
% In two companion papers, we describe an R package \texttt{vqtl} implementing our procedure (\CortyRPaper), and in \CortyReanalysisPaper apply it to two published QTL mapping experiments detecting a novel mQTL in one and a novel vQTL in the other.

% END OF INTRODUCTION

% Here we describe a framework for ``mean-variance QTL mapping'' based on the DGLM approach of \AddRefs{RonnegardValdar11} that accommodate and even take advance of BVH, and can be used to detect and distinguish three types of QTL:
% \begin{enumerate}
%     \item mQTL: a locus containing a genetic factor that causes heterogenity of phenotype mean,
%     \item vQTL: a locus containing a genetic factor that causes heterogenity of phenotype variance, and
%     \item mvQTL: a locus containing a genetic factor that causes heterogenity of either phenotype mean, variance, or both -- a generalization that includes the other two classes.
% \end{enumerate}
% We show that this framework is more powerful than competitor methods in the presence of BVH, and introduce a permutation procedure for discriminating between mQTL, vQTL and mvQTL regardless of whether BVH is present. 

%It brings the statistical model into greater accord with the data-generating process and thus allow for the detection of smaller effects at a given false positive rate and population size \citep{Smyth1989}.}

%The use of the DGLM in QTL mapping was introduced by \cite{Ronnegard2011a}, and has been further described by \cite{Hulse2013} and \cite{Lenz2015}.
% The value of detecting vQTL and mvQTL has been debated \citep{Sun2013a} and affirmed \citep{Shen2013}[more cites].
% But still, efforts to detect them are seen as a separate endeavour from traditional, SLM-based QTL mapping.
% This artificial division is likely due in part to a lack of awareness of the utility of vQTL and mvQTL, but more pressingly to the lack of an established framework for their detection and interpretation.

% Here, we describe mean-variance QTL mapping, a framework for QTL mapping with the DGLM that can detect mQTL, vQTL, and mvQTL and has additional power to do so relative to other tests in the face of BVH.
% Additionally, we describe a permutation procedure for significance testing that accurately controls false positive rate in the presence of BVH.

%We assess the performance of the DGLM in a variety of relevant scenarios through simulation and characterize its trade-offs as compared to other approaches, and illustrate one real data example where an mQTL was detected by the DGLM-based method but not by any other QTL mapping methods.



% \section{Extra Prose 1}
% Over the last 25 years, interval mapping based on the assumption of homogeneous residual variance and its associated statistical methods \citep{Lander1989a,Martinez1992,Haley1992,Churchill1994} have successfully identified many QTL that influence the epected value of important complex traits.
%     It is well-appreciated, however, that this approach fails to capture all the complexities of the relationship between genotype and phenotype \citep{GeilerSamerotte2013,Nelson2013,Shen2012,Forsberg2015,Pare2010}.

%     One way that scientists have sought to address these complexities is to reweight observations based on their inferred reliability \citep{Xu1998} or the inferred reliability of their genotype \citep{Feenstra2006}.
%     A similar approach has recently been enacted in human studies as well \citep{Ma2015}.

%     Another approach has been to attempt to identify specific genetic loci that cause heterogeneity of residual variance, while simultaneously controlling for possible effects on the mean.
%     Two, closely related efforts on this front were the application of the double generalized linear model (DGLM; \citealt{Smyth1989}) to QTL mapping \citep{Ronnegard2011a} and the omnibus test of \citet{Cao2014} for genetic heterogeneity.
%     Both of these approaches can detect standard QTL influencing phenotype mean (mQTL), QTL influencing phenotype variance (vQTL) and QTL influencing some combination of phenotype mean and variance (mvQTL) (see \CortyMethodsPaper).
%     Despite the demonstrated potential of these methods to detect QTL that current standard methods overlook, they remain underutilized.

%     Barriers to widespread adoption include a lack of proven potential in real data applications and the absence of software that is interoperable with existing infrastructure.
%     Apart from those barriers, one reasonable concern is that a novel approach might fail to identify known QTL, adding needless complexity to the interpretation of already-reported QTL.
%     This concern should be largely allayed by the nature of the DGLM as an extension of the linear model, simplifying to the latter when variance heterogeneity is absent.
%     In fact, rather than add complexity, the DGLM automatically classifies QTL into mQTL, vQTL, or mvQTL, clarifying the genotype-phenotype relationship.

%     Here we demonstrate, with two real data examples available from the Mouse Phenome Database \citep{Bogue2015}, that QTL mapping using the DGLM, which we term ``mean-variance QTL mapping'' largely replicates the results of standard QTL mapping and detects additional QTL that the traditional analysis does not.
%     In two companion articles, we demonstrate typical usage of \texttt{R} package \texttt{vqtl}, which implements mean-variance QTL mapping  (\CortyRPaper) and 
%     % provides a flexible and comprehensive suite of tools to conduct genome scans using the double generalized linear model, assess the statistical significant of results, and interpret findings.
%     describe the unique ability of mean-variance QTL mapping and its associated permutation procedure to reliably detect QTL in the face of variance heterogeneity that arises from non-genetic factors (\CortyMethodsPaper).


% \section{Extra Prose 2}

% QTL mapping studies in experimental crosses have provided important insights on nearly every trait of interest in human health, as well as livestock and crop improvement programs.
% Advances in model organism genotyping \citep{Williams1990} and phenotyping \citep{Yang2014a} as well as in statistical methods \citep{Lander1989a,Martinez1992} and software tools (\eg, \citealt{Broman2003,Mulligan2017}) have supported these discoveries.

% It has long been recognized that the extent of residual variation is itself a heritable trait \citep{Falconer1965,Lynch1998}.
% This phenomenon has been described theoretically \citep{Hill2004-uo,Hill2010} and demonstrated in inbred model organisms \citep{Sorensen2015,Ayroles2015} and crops \citep{Yang2012-aw,Forsberg2015} and exploited in livestock improvement efforts \citep{Mulder2008,Ibanez-Escriche2008-ie}.

% However, traditional QTL mappinng analyses have focused on discovering ``mean QTL'', regions of the genome where allelic variation drives heterogeneity of phenotype mean, while assuming that the residual variance, that is, the intrinsic stability or noisiness of the phenotype, is identical for each every individual in the mapping population.
% Recent work, however, has challenged the assumption of homogeneous variance and sought to identify an additional type of QTL --- those that
% %, by driving heterogeneity of epistatic or environmental variance, 
% influence the extent of residual variance, sometimes termed ``variance QTL'' (vQTL) \citep{Pare2010,Ronnegard2011a,Ronnegard2012,Cao2014}.

% Although detection of vQTL has started to enter the mainstream of genetic analysis \citep{Yang2012,Hulse2013,Ayroles2015,Wei2016-lt,Wang2017,Wei2017-tt}, the statistical methods used for this purpose remain heterogeneous.
% % and sometimes idiosyncratic, with connections to methods for mapping mean QTL often lacking or unclear.
% % a clear or intuitive connection to methods used for detecting mean QTL.
% %there remains great heterogeneity among the statistical methods used to conduct these analyses.
% We developed a standardized method for QTL mapping that can detect mQTL, vQTL, and a generalization of the two that we term ``mvQTL''.
% This approach, which we term ``mean-variance QTL mapping'', can be applied to intercross and backcross designs.
% In two companion articles, we characterize this method and competitors in the setting where a background factor drives variance heterogeneity (\CortyMethodsPaper), and use it to discover new QTL from two existing data resources (\CortyReanalysisPaper)

% Here, we provide a practical guide to using the \texttt{R} package \texttt{vqtl}, which implements mean-variance QTL mapping.
% First, to generate illustrative data, we simulate an F2 intercross and four phenotypes: one phenotype determined entirely by random noise, and one with each of the three kinds of QTL.
% On each phenotype we then conduct a genome scan using standard approximations to interval mapping \citep{Lander1989a,Martinez1992}, and mean-variance QTL mapping, which includes a test for mQTL, a test for vQTL, and a test for mvQTL.
% The association statistics of all four tests are then initially plotted in LOD score units, with drawbacks of this plotting unit discussed.
% Permutation scans are used to determine empirically adjusted $p$-values, and plotting in these units is shown to to make the results of the four tests more comparable.
% Last, we describe plots to communicate the effects that led to the detection of a QTL, and use the bootstrap to estimate its confidence interval.

% In two companion articles, we apply mean-variance QTL mapping with package \texttt{vqtl} to discover new QTL.
% In the first, we describe a novel vQTL for exploratory behavior and a novel mQTL for a circadian behavior trait, both in mouse F2 intercrosses retrieved from the Mouse Phenome Database (\CortyReanalysisPaper) \citep{Bogue2015}.
% The dataset from one of these intercrosses is used to benchmark the performance of package \texttt{vqtl}, as is described in the ``Performance Benchmarks'' section.
% In the second, we describe a unique strength of mean-variance QTL mapping, its ability to accommodate variance heterogeneity arising from background factors, such as sex, batch, and housing, and demonstrate the value of such accommodation with both simulation studies and a report of a novel QTL (\CortyMethodsPaper).